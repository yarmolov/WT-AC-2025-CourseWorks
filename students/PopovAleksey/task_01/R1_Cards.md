# Вариант 02 — Карточки (пользовательские истории и критерии приёмки)

## 1. Как студент я хочу просмотреть доступные аудитории

**Описание**: Студент открывает календарь и видит список аудиторий с информацией о занятости.

**Критерии приёмки (AC)**:

- AC1: Календарь отображает все аудитории с их названиями и параметрами
- AC2: Занятые слоты времени помечены как недоступные
- AC3: Можно фильтровать по вместимости и оборудованию
- AC4: Интерфейс отзывчивый и загружается менее чем за 2 секунды

**Валидация полей**:

- date: datetime, не пустое → ошибка: «Выберите дату.»
- capacity: number, опционально (для фильтра)

---

## 2. Как студент я хочу забронировать аудиторию

**Описание**: Студент выбирает аудиторию, дату, время и создаёт бронирование.

**Критерии приёмки (AC)**:

- AC1: Форма бронирования содержит поля: аудитория, дата, время начала/окончания, цель
- AC2: Система проверяет конфликты перед созданием бронирования
- AC3: При конфликте отображается сообщение с занятыми слотами
- AC4: Студент может забронировать максимум на 2 часа
- AC5: После создания бронирования отображается подтверждение

**Валидация полей**:

- room_id: reference -> Room.id, не пустое → ошибка: «Выберите аудиторию.»
- start_time: datetime, не пустое → ошибка: «Укажите время начала.»
- end_time: datetime, не пустое, > start_time → ошибка: «Время окончания должно быть позже начала.»
- purpose: string, не пустое, max 500 → ошибка: «Укажите цель бронирования (до 500 символов).»

---

## 3. Как преподаватель я хочу забронировать аудиторию на длительный срок

**Описание**: Преподаватель создаёт бронирование на срок до 4 часов.

**Критерии приёмки (AC)**:

- AC1: Преподаватель может забронировать аудиторию до 4 часов
- AC2: Система проверяет роль пользователя при создании бронирования
- AC3: Если бронирование превышает лимит роли, отображается ошибка
- AC4: Преподаватель видит свой лимит времени в интерфейсе

**Валидация полей**:

- duration: вычисляется как end_time - start_time, проверка: <= 4 часа для teacher → ошибка: «Преподаватель может бронировать до 4 часов.»

---

## 4. Как пользователь я хочу отменить своё бронирование

**Описание**: Пользователь открывает список своих бронирований и отменяет одно из них.

**Критерии приёмки (AC)**:

- AC1: Список бронирований отображает все активные и прошлые бронирования пользователя
- AC2: Кнопка «Отменить» доступна только для будущих бронирований
- AC3: После отмены статус меняется на 'cancelled'
- AC4: Отменённое бронирование исчезает из календаря
- AC5: Система записывает в лог информацию об отмене

**Валидация**:

- booking_id: UUID, должно существовать → ошибка: «Бронирование не найдено.»
- user_id: должен совпадать с создателем или быть админом → ошибка: «Недостаточно прав.»

---

## 5. Как пользователь я хочу перенести бронирование

**Описание**: Пользователь изменяет время своего бронирования.

**Критерии приёмки (AC)**:

- AC1: Форма редактирования позволяет изменить start_time и end_time
- AC2: Система проверяет конфликты на новое время
- AC3: При конфликте предлагаются альтернативные варианты
- AC4: После переноса обновляется календарь
- AC5: Сохраняется история изменений в audit log

**Валидация полей**:

- new_start_time: datetime, не пустое → ошибка: «Укажите новое время начала.»
- new_end_time: datetime, не пустое, > new_start_time → ошибка: «Время окончания должно быть позже начала.»

---

## 6. Как администратор я хочу управлять аудиториями

**Описание**: Администратор создаёт, редактирует и удаляет аудитории.

**Критерии приёмки (AC)**:

- AC1: Форма создания аудитории содержит поля: название, описание, вместимость, оборудование, расположение
- AC2: Все поля валидируются перед сохранением
- AC3: Администратор может редактировать существующие аудитории
- AC4: При удалении аудитории проверяется наличие активных бронирований
- AC5: Если есть активные бронирования, отображается предупреждение

**Валидация полей**:

- name: string, не пустое, unique → ошибка: «Введите уникальное название аудитории.»
- capacity: number, не пустое, > 0 → ошибка: «Вместимость должна быть больше 0.»
- equipment: string, опционально
- location: string, не пустое → ошибка: «Укажите расположение аудитории.»

---

## 7. Как администратор я хочу просматривать статистику использования

**Описание**: Администратор видит отчёты по использованию аудиторий и активности пользователей.

**Критерии приёмки (AC)**:

- AC1: Страница статистики отображает общее количество бронирований за период
- AC2: Можно фильтровать по аудитории, пользователю, дате
- AC3: Отображается загруженность каждой аудитории в процентах
- AC4: Есть возможность экспортировать отчёт в CSV
- AC5: Графики и диаграммы визуализируют данные

**Валидация полей**:

- from: datetime, опционально (по умолчанию: начало месяца)
- to: datetime, опционально (по умолчанию: текущая дата)

---

## 8. **[BONUS]** Как пользователь я хочу получать уведомления о моих бронированиях

**Описание**: Система отправляет напоминания за час до начала бронирования.

**Критерии приёмки (AC)**:

- AC1: За 1 час до начала бронирования пользователь получает уведомление
- AC2: Уведомление содержит информацию: аудитория, время, цель
- AC3: Пользователь может отключить уведомления в настройках
- AC4: Уведомления доставляются через WebSocket или email

**Валидация**:

- notification_enabled: boolean, default true

---

## 9. Как администратор я хочу отменить любое бронирование

**Описание**: Администратор может отменить бронирование любого пользователя в случае необходимости.

**Критерии приёмки (AC)**:

- AC1: Администратор видит все бронирования всех пользователей
- AC2: Кнопка «Отменить» доступна для любого бронирования
- AC3: При отмене запрашивается причина
- AC4: Пользователь получает уведомление об отмене администратором
- AC5: Информация об отмене сохраняется в audit log

**Валидация полей**:

- reason: string, обязательно для admin, 10-500 символов → ошибка: «Администратор должен указать причину отмены (10-500 символов).»
- система проверяет роль: если admin отменяет чужое бронирование, поле reason обязательно

---

## 10. **[BONUS]** Как пользователь я хочу экспортировать расписание в календарь

**Описание**: Пользователь скачивает свои бронирования в формате iCal для импорта в Google Calendar или Outlook.

**Критерии приёмки (AC)**:

- AC1: Кнопка «Экспорт» доступна на странице бронирований
- AC2: Генерируется файл .ics с корректными данными
- AC3: Файл включает все будущие бронирования пользователя
- AC4: События в календаре содержат название аудитории, время и цель
- AC5: Файл корректно импортируется в популярные календарные приложения

**Валидация**:

- format: enum ['ical'], default 'ical'
