# Вариант 09 — Блог «Лонгрид? Коротко!» — Роли и действия

## Краткое описание системы

MVP: User, Post, Tag, Comment, Like. Пользователи создают посты с Markdown, сохраняют черновики, публикуют контент. Читатели лайкают и комментируют. Администраторы управляют пользователями и контентом.

API: `/auth`, `/posts`, `/tags`, `/comments`, `/likes`, `/users` (admin)

Приёмка (MVP): редактор постов, предпросмотр Markdown, черновики, лайки, комментарии, роли с правами доступа.

## Роли в системе

### 1. Гость (неавторизованный пользователь)

**Основные возможности:**

- Просмотр ленты опубликованных постов
- Чтение полного текста постов
- Просмотр комментариев
- Просмотр количества лайков
- Фильтрация постов по тегам
- Поиск постов по заголовкам и содержимому

**Ограничения:**

- Нельзя создавать посты
- Нельзя лайкать посты
- Нельзя комментировать
- Нет доступа к черновикам
- Нет доступа к профилю

### 2. Пользователь (авторизованный)

**Основные возможности:**

- Все возможности гостя +
- Создание новых постов
- Редактирование своих постов (опубликованных и черновиков)
- Удаление своих постов
- Сохранение постов как черновики (published = false)
- Публикация черновиков (published = true)
- Добавление тегов к своим постам (выбор из существующих)
- Лайк любых опубликованных постов (toggle: добавить/удалить лайк)
- Комментирование любых опубликованных постов
- Редактирование своих комментариев
- Удаление своих комментариев
- Просмотр только своих черновиков

**Ограничения:**

- Нельзя редактировать/удалять чужие посты
- Нельзя редактировать/удалять чужие комментарии
- Нельзя создавать новые теги (только выбор существующих)
- Нет доступа к управлению пользователями
- Нет доступа к аналитике

### 3. Администратор

**Основные возможности:**

- Все возможности пользователя +

- **Управление пользователями:**

  - Просмотр списка всех пользователей
  - Создание новых пользователей
  - Изменение ролей пользователей (user ↔ admin)
  - Удаление пользователей

- **Управление контентом:**

  - Редактирование любых постов (включая чужие)
  - Удаление любых постов
  - Удаление любых комментариев (модерация)

- **Управление тегами:**

  - Создание новых тегов
  - Редактирование названий тегов
  - Удаление тегов

- **Аналитика и статистика (бонус):**

  - Просмотр статистики по активности
  - Просмотр логов системы

## Детальная таблица действий × роли

| Действие                                    | Гость | Пользователь | Администратор |
|---------------------------------------------|-------|--------------|---------------|
| **Посты**                                   |       |              |               |
| Просмотр ленты опубликованных постов        | ✓     | ✓            | ✓             |
| Просмотр полного текста поста               | ✓     | ✓            | ✓             |
| Создание нового поста                       | ✗     | ✓            | ✓             |
| Редактирование своего поста                 | ✗     | ✓            | ✓             |
| Редактирование чужого поста                 | ✗     | ✗            | ✓             |
| Удаление своего поста                       | ✗     | ✓            | ✓             |
| Удаление чужого поста                       | ✗     | ✗            | ✓             |
| Сохранение поста как черновик               | ✗     | ✓            | ✓             |
| Публикация черновика                        | ✗     | ✓            | ✓             |
| Просмотр своих черновиков                   | ✗     | ✓            | ✓             |
| Просмотр чужих черновиков                   | ✗     | ✗            | ✓             |
| **Комментарии**                             |       |              |               |
| Просмотр комментариев                       | ✓     | ✓            | ✓             |
| Создание комментария                        | ✗     | ✓            | ✓             |
| Редактирование своего комментария           | ✗     | ✓            | ✓             |
| Удаление своего комментария                 | ✗     | ✓            | ✓             |
| Удаление чужого комментария                 | ✗     | ✗            | ✓             |
| **Лайки**                                   |       |              |               |
| Просмотр количества лайков                  | ✓     | ✓            | ✓             |
| Лайк поста (добавить/удалить)               | ✗     | ✓            | ✓             |
| **Теги**                                    |       |              |               |
| Просмотр тегов                              | ✓     | ✓            | ✓             |
| Добавление существующего тега к своему посту| ✗     | ✓            | ✓             |
| Создание нового тега                        | ✗     | ✗            | ✓             |
| Удаление тега                               | ✗     | ✗            | ✓             |
| **Пользователи**                            |       |              |               |
| Регистрация                                 | ✓     | ✗            | ✓             |
| Вход в систему                              | ✓     | ✓            | ✓             |
| Просмотр списка пользователей               | ✗     | ✗            | ✓             |
| Создание пользователя                       | ✗     | ✗            | ✓             |
| Изменение роли пользователя                 | ✗     | ✗            | ✓             |
| Удаление пользователя                       | ✗     | ✗            | ✓             |
| **Дополнительно**                           |       |              |               |
| Поиск постов                                | ✓     | ✓            | ✓             |
| Фильтрация по тегам                         | ✓     | ✓            | ✓             |
| Просмотр аналитики                          | ✗     | ✗            | ✓             |

## Примеры сценариев по ролям

### Сценарий 1: Гость становится пользователем

1. Гость читает интересные посты на главной странице
2. Хочет прокомментировать → система предлагает войти/зарегистрироваться
3. Гость регистрируется (email, password, name)
4. Получает JWT токен, становится авторизованным пользователем
5. Теперь может комментировать, лайкать, создавать посты

### Сценарий 2: Пользователь публикует лонгрид

1. Авторизованный пользователь создаёт новый пост
2. Пишет длинный текст на Markdown с форматированием
3. Сохраняет как черновик (пока не готово публиковать)
4. Возвращается через день, дорабатывает текст
5. Использует предпросмотр для проверки рендеринга
6. Добавляет теги: "технологии", "web", "tutorial"
7. Публикует пост → он появляется в общей ленте
8. Другие пользователи читают, лайкают и комментируют

### Сценарий 3: Администратор модерирует контент

1. Администратор получает жалобу на неприемлемый комментарий
2. Заходит в админ-панель, находит комментарий
3. Удаляет оскорбительный комментарий
4. Просматривает активность автора комментария
5. Если нарушения повторяются → удаляет пользователя
6. Создаёт новый тег для улучшения категоризации
7. Просматривает статистику активности за неделю
