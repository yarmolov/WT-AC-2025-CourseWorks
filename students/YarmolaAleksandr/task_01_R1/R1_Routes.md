# Вариант 09 — Блог «Лонгрид? Коротко!» — Маршруты (user flows)

## 1. Идентификация (вход в систему)

- **Гость (неавторизованный)**: просмотр ленты публичных постов → регистрация/вход
- **Пользователь**: логин → личный кабинет с черновиками и опубликованными постами
- **Администратор**: логин → админ-панель (управление пользователями, роли, контент)

## 2. Публичный доступ (Гость)

- **Главная страница**: список опубликованных постов с превью (заголовок + первые 200 символов)
- **Фильтрация**: по тегам, дате публикации, популярности (количество лайков)
- **Поиск**: по заголовкам, тегам, содержимому постов
- **Просмотр поста**: полный текст, список комментариев, количество лайков
- **Ограничения**: нельзя лайкать, комментировать без авторизации

## 3. Создание контента (Автор)

- **Создать новый пост**:
  - Редактор с поддержкой Markdown
  - Поля: заголовок (обязательно), содержание (обязательно), теги (опционально)
  - Кнопка "Предпросмотр" для просмотра рендеринга Markdown
- **Сохранить как черновик**: пост не виден публично (published = false)
- **Опубликовать**: пост становится доступен всем читателям (published = true)
- **Редактировать свои посты**: изменение черновиков и опубликованных постов
- **Удалить пост**: только свои посты (черновики или опубликованные)

## 4. Работа с черновиками (Автор)

- **Список черновиков**: все неопубликованные посты автора
- **Редактирование черновика**: продолжить работу над постом
- **Публикация из черновика**: изменить статус published на true
- **Планирование публикации (бонус)**: установить дату/время автоматической публикации

## 5. Взаимодействие с контентом (Авторизованный пользователь)

- **Лайк поста**: добавить/убрать свой лайк (toggle)
- **Комментарий к посту**: написать комментарий под постом
- **Редактирование комментария**: изменить или удалить только свой комментарий
- **Просмотр профиля**: посты других авторов, подписка (бонус)

## 6. Управление системой (Администратор)

- **CRUD пользователей**: создание, изменение ролей (user ↔ admin), удаление
- **CRUD тегов**: создание новых тегов, удаление неиспользуемых
- **Управление постами**: редактирование/удаление любых постов (включая чужие)
- **Модерация комментариев**: удаление неприемлемых комментариев
- **Просмотр аналитики (бонус)**: статистика по постам, пользователям, активности

## 7. Основные сценарии использования (User Stories)

### Сценарий 1: Гость читает посты

1. Гость заходит на главную страницу
2. Видит список опубликованных постов с превью
3. Кликает на интересный пост → читает полный текст
4. Видит комментарии и количество лайков
5. Хочет лайкнуть → система предлагает войти/зарегистрироваться

### Сценарий 2: Автор создаёт и публикует пост

1. Авторизованный пользователь переходит в редактор
2. Вводит заголовок и содержание (Markdown)
3. Добавляет теги для категоризации
4. Нажимает "Предпросмотр" → видит итоговый вид поста
5. Сохраняет как черновик (работа не завершена)
6. Позже возвращается, редактирует черновик
7. Нажимает "Опубликовать" → пост появляется в общей ленте

### Сценарий 3: Читатель взаимодействует с контентом

1. Авторизованный пользователь читает пост
2. Ставит лайк → счётчик лайков увеличивается
3. Пишет комментарий → комментарий появляется под постом
4. Замечает опечатку в своём комментарии → редактирует его
5. Просматривает другие посты с тем же тегом

### Сценарий 4: Администратор управляет контентом

1. Админ входит в админ-панель
2. Видит список всех пользователей
3. Изменяет роль активного автора на "admin"
4. Замечает некорректный комментарий → удаляет его
5. Создаёт новый тег для категоризации постов
6. Просматривает аналитику по активности пользователей

## 8. Маршруты клиента (React Router)

- `/` — главная страница (лента постов)
- `/login` — форма входа
- `/register` — форма регистрации
- `/posts/:id` — просмотр полного поста
- `/posts/new` — создание нового поста (защищено)
- `/posts/:id/edit` — редактирование поста (защищено, только владелец/admin)
- `/drafts` — список черновиков (защищено)
- `/tags` — список всех тегов
- `/tags/:name` — посты по конкретному тегу
- `/admin/users` — управление пользователями (только admin)
- `/admin/tags` — управление тегами (только admin)
- `/profile/:userId` — профиль пользователя (бонус)

## 9. Защита маршрутов

- **Публичные**: `/`, `/login`, `/register`, `/posts/:id`, `/tags`
- **Требуют авторизации**: `/posts/new`, `/posts/:id/edit`, `/drafts`
- **Только admin**: `/admin/*`
- **Middleware**: `authMiddleware` проверяет JWT токен
- **Редирект**: при попытке доступа к защищённому роуту без авторизации → `/login`
