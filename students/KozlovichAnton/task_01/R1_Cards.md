# Вариант 11 — Карточки (обязательные поля и валидации)

## 1. Форма аутентификации

### Регистрация (только bootstrap первого admin)

- username: string, 3-20 символов, только латиница/цифры/underscore → ошибка: «Имя пользователя: 3-20 символов, латиница, цифры, _»
- email: string, валидный email → ошибка: «Введите корректный email»
- password: string, минимум 8 символов, должен содержать: заглавную букву, строчную, цифру → ошибка: «Пароль: минимум 8 символов, заглавная, строчная, цифра»

### Логин

- email: string, не пустое → ошибка: «Введите email»
- password: string, не пустое → ошибка: «Введите пароль»

## 2. Карточка пользователя (User) - для Admin

- id: UUID, автогенерируется
- username: string, 3-20 символов, уникальное → ошибка: «Имя пользователя занято» или «3-20 символов»
- email: string, валидный email, уникальное → ошибка: «Email уже используется» или «Некорректный email»
- password: string (при создании), минимум 8 символов → ошибка: «Пароль: минимум 8 символов»
- role: enum ['admin', 'manager', 'developer', 'user'], не пустое → ошибка: «Выберите роль»
- created_at: datetime, автогенерируется

## 3. Карточка проекта (Project)

- id: UUID, автогенерируется
- name: string, 3-100 символов, не пустое → ошибка: «Введите название проекта (3-100 символов)»
- description: text, опционально, максимум 2000 символов → ошибка: «Описание: максимум 2000 символов»
- owner_id: reference -> User.id, не пустое → ошибка: «Выберите владельца проекта»
- is_public: boolean, default: false
- created_at: datetime, автогенерируется
- updated_at: datetime, автогенерируется

## 4. Карточка участника проекта (ProjectMember)

- id: UUID, автогенерируется
- project_id: reference -> Project.id, не пустое → ошибка: «Проект не найден»
- user_id: reference -> User.id, не пустое → ошибка: «Выберите пользователя»
- role: enum ['owner', 'manager', 'developer', 'viewer'], не пустое → ошибка: «Выберите роль в проекте»
- joined_at: datetime, автогенерируется
- Валидация: unique(project_id, user_id) → ошибка: «Пользователь уже участник проекта»

## 5. Карточка бага (Bug)

- id: UUID, автогенерируется
- project_id: reference -> Project.id, не пустое → ошибка: «Выберите проект»
- title: string, 3-200 символов, не пустое → ошибка: «Введите название бага (3-200 символов)»
- description: text, опционально, максимум 5000 символов → ошибка: «Описание: максимум 5000 символов»
- status: enum ['new', 'in_progress', 'testing', 'done', 'closed'], не пустое, default: 'new' → ошибка: «Укажите статус»
- priority: enum ['low', 'medium', 'high', 'critical'], не пустое, default: 'medium' → ошибка: «Укажите приоритет»
- assigned_to: reference -> User.id, опционально → ошибка: «Выберите разработчика из участников проекта»
- created_by: reference -> User.id, не пустое, автоматически из JWT
- created_at: datetime, автогенерируется
- updated_at: datetime, автогенерируется при каждом изменении

## 6. Карточка вложения (Attachment)

- id: UUID, автогенерируется
- bug_id: reference -> Bug.id, не пустое → ошибка: «Баг не найден»
- filename: string, не пустое → ошибка: «Выберите файл для загрузки»
- file_path: string, автогенерируется на сервере
- uploaded_by: reference -> User.id, не пустое, автоматически из JWT
- uploaded_at: datetime, автогенерируется
- Валидация файла:
  - Размер: максимум 10MB → ошибка: «Размер файла не должен превышать 10MB»
  - Типы: image/*, application/pdf, text/plain, text/csv → ошибка: «Неподдерживаемый тип файла. Разрешены: изображения, PDF, текстовые файлы»

## 7. Карточка комментария (Comment)

- id: UUID, автогенерируется
- bug_id: reference -> Bug.id, не пустое → ошибка: «Баг не найден»
- author_id: reference -> User.id, не пустое, автоматически из JWT
- content: text, не пустое, 1-2000 символов → ошибка: «Введите текст комментария (1-2000 символов)»
- created_at: datetime, автогенерируется
- Дополнительная обработка: HTML санитизация (защита от XSS)

## Пользовательские истории (User Stories)

### US-1: Создание проекта

**Как** администратор  
**Я хочу** создать новый проект  
**Чтобы** организовать работу с багами в рамках проекта

**Критерии приёмки:**

- Форма создания проекта содержит поля: name, description, is_public
- После успешного создания пользователь перенаправляется на страницу проекта
- Валидация: name не может быть пустым

### US-2: Создание бага

**Как** пользователь  
**Я хочу** создать новый баг в проекте  
**Чтобы** сообщить о проблеме

**Критерии приёмки:**

- Форма создания содержит поля: title, description, priority
- Баг создаётся со статусом "new" по умолчанию
- created_by автоматически заполняется текущим пользователем
- Валидация: title не может быть пустым, project_id обязателен

### US-3: Просмотр списка багов с фильтрами

**Как** пользователь  
**Я хочу** просматривать баги с возможностью фильтрации  
**Чтобы** быстро найти нужные баги

**Критерии приёмки:**

- Доступны фильтры: по статусу, приоритету, назначенному разработчику
- Фильтры работают независимо и могут комбинироваться
- Результаты обновляются при изменении фильтров
- Пагинация работает корректно

### US-4: Kanban-доска

**Как** менеджер  
**Я хочу** видеть баги на Kanban-доске  
**Чтобы** отслеживать прогресс работы

**Критерии приёмки:**

- Доска содержит колонки для каждого статуса (new, in_progress, testing, done, closed)
- Баги отображаются в соответствующих колонках
- Возможность перемещать баги между колонками (бонус)
- Фильтры по приоритету работают на доске

### US-5: Назначение бага на разработчика

**Как** менеджер  
**Я хочу** назначить баг на разработчика  
**Чтобы** распределить работу

**Критерии приёмки:**

- В карточке бага есть поле для выбора разработчика (assigned_to)
- Список содержит только пользователей с ролью developer
- После назначения разработчик видит баг в своём списке задач
- История изменений фиксирует назначение

### US-6: Добавление комментария

**Как** пользователь  
**Я хочу** добавить комментарий к багу  
**Чтобы** предоставить дополнительную информацию

**Критерии приёмки:**

- Форма добавления комментария доступна на странице бага
- Комментарий отображается с именем автора и временем создания
- Валидация: content не может быть пустым
- Все участники проекта видят новый комментарий

### US-7: Добавление вложения

**Как** пользователь  
**Я хочу** прикрепить файл к багу  
**Чтобы** предоставить скриншот или лог ошибки

**Критерии приёмки:**

- Форма загрузки файла доступна на странице бага
- Поддерживаются файлы: изображения, документы, логи
- Вложение отображается в списке с именем файла и автором
- Возможность скачать вложение

### US-8: Изменение статуса бага

**Как** разработчик  
**Я хочу** изменить статус бага  
**Чтобы** отразить текущее состояние работы

**Критерии приёмки:**

- Доступен выбор статуса из списка (new, in_progress, testing, done, closed)
- При изменении статуса обновляется updated_at
- История изменений фиксирует смену статуса
- Только назначенный разработчик или менеджер могут менять статус

### US-9: Изменение приоритета бага

**Как** менеджер  
**Я хочу** изменить приоритет бага  
**Чтобы** управлять важностью задач

**Критерии приёмки:**

- Доступен выбор приоритета: low, medium, high, critical
- При изменении приоритета обновляется updated_at
- Баги с высоким приоритетом выделяются визуально
- История изменений фиксирует смену приоритета

### US-10: Управление участниками проекта

**Как** владелец проекта  
**Я хочу** добавлять и удалять участников проекта  
**Чтобы** контролировать, кто имеет доступ к проекту и его багам

**Критерии приёмки:**

- В настройках проекта есть раздел "Участники"
- Можно добавить пользователя, выбрав его из списка и указав роль (manager, developer, viewer)
- Можно изменить роль существующего участника (только owner)
- Можно удалить участника из проекта (только owner)
- Нельзя удалить owner'а проекта
- При добавлении дублирующего участника отображается ошибка
