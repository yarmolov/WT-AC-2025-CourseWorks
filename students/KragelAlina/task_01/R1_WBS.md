# Вариант 29 — WBS (эпики → фичи → задачи)

**Статус**: Большинство эпиков A-G уже реализовано, некоторые находятся в разработке

## ✅ Эпик A. Модель данных и структура БД

A. **Статус: ЗАВЕРШЁН**

Фичи: User, Title, Person, List, Review, Rating (SQLAlchemy модели)

Задачи:

- A1. ✅ Описать таблицы и связи (ERD) — в R1_ERD.md
- A2. ✅ Определить SQLAlchemy модели (models.py)
- A3. ✅ Создать Pydantic schemas для валидации (schemas.py)

---

## ✅ Эпик B. Каталог фильмов и поиск

B. **Статус: ЗАВЕРШЁН**

Фичи: CRUD /titles (admin), фильтрация, пагинация, загрузка из TMDB

Задачи:

- B1. ✅ POST /titles (create, admin only)
- B2. ✅ GET /titles (с фильтрацией по name, genre, year и пагинацией)
- B3. ✅ GET /titles/{id} (детали фильма)
- B4. ✅ PUT /titles/{id} (update, admin only)
- B5. ✅ DELETE /titles/{id} (delete, admin only)
- B6. ✅ POST /admin/load_movies (загрузка фильмов из TMDB с сухим прогоном)

---

## ✅ Эпик C. Список просмотра (watchlist)

C. **Статус: ЗАВЕРШЁН**

Фичи: добавление фильмов в список, управление статусом просмотра, удаление

Задачи:

- C1. ✅ GET /lists (список фильмов текущего пользователя с пагинацией)
- C2. ✅ POST /lists (добавить фильм в список или обновить статус)
- C3. ✅ DELETE /lists/{id} (удалить фильм из списка)
- C4. ✅ Статусы: watching, planned, completed, dropped
- C5. ⏳ UI страница "Мой список" — в разработке

---

## ✅ Эпик D. Рецензии

D. **Статус: ЗАВЕРШЁН**

Фичи: написание/редактирование/удаление рецензий, просмотр

Задачи:

- D1. ✅ GET /reviews (список с фильтром по title_id и user_id)
- D2. ✅ POST /reviews (написать рецензию, уникальность по user_id + title_id)
- D3. ✅ DELETE /reviews/{id} (удалить рецензию, проверка автора)
- D4. ✅ Обновление существующей рецензии при повторной попытке
- D5. ⏳ UI отображения рецензий — в разработке

---

## ✅ Эпик E. Оценки (Ratings)

E. **Статус: ЗАВЕРШЁН**

Фичи: оценивание фильмов (1-10), просмотр оценок

Задачи:

- E1. ✅ GET /ratings (список оценок с фильтром по title_id и user_id)
- E2. ✅ POST /ratings (поставить оценку 1-10, уникальность по user_id + title_id)
- E3. ✅ DELETE /ratings/{id} (удалить оценку, проверка автора)
- E4. ✅ Обновление существующей оценки при повторной попытке
- E5. ✅ Валидация score в диапазоне 1-10 (Pydantic)

---

## ✅ Эпик F. Персоны

F. **Статус: РЕАЛИЗОВАНО (базовая функциональность)**

Фичи: добавление актёров и режиссёров к фильмам

Задачи:

- F1. ✅ SQLAlchemy модель Person (id, name, role, title_id)
- F2. ✅ Связь Title.persons (one-to-many)
- F3. ⏳ API для CRUD персон — в разработке
- F4. ⏳ UI отображения персоналий на странице фильма

---

## ✅ Эпик G. Аутентификация и авторизация

G. **Статус: ЗАВЕРШЁН**

Фичи: регистрация, логин, JWT, RBAC (user/admin)

Задачи:

- G1. ✅ POST /register {username, password} → создание user
- G2. ✅ POST /login {username, password} → возврат JWT token
- G3. ✅ JWT декодирование и проверка в @jwt_required()
- G4. ✅ Роли: user (default), admin
- G5. ✅ Проверка роли в админ-эндпоинтах (POST /titles, DELETE /titles, etc.)
- G6. ✅ Документирование матрицы прав в R1_Matrix_of_Rights.md

---

## ⏳ Эпик H. UI / интерфейс пользователя

H. **Статус: В РАЗРАБОТКЕ**

Фичи: главная страница, фильтры, детальная страница фильма, личный кабинет

Задачи:

- H1. ✅ index.html (главная страница со списком фильмов)
- H2. ✅ main.js (загрузка фильмов, фильтрация, пагинация)
- H3. ⏳ profile.html (личный кабинет пользователя)
- H4. ⏳ Страница детали фильма (reviews, ratings, persons)
- H5. ⏳ Форма добавления фильма в список
- H6. ⏳ Форма написания рецензии
- H7. ⏳ Форма оценивания фильма

---

## ⏳ Эпик I. Документация и тесты

I. **Статус: ЧАСТИЧНО ЗАВЕРШЕНО**

Фичи: API документация (Swagger), unit/integration тесты

Задачи:

- I1. ✅ Flasgger Swagger UI на /apidocs
- I2. ✅ Docstrings в app.py для всех эндпоинтов
- I3. ✅ Unit тесты в tests/test_api.py
- I4. ⏳ Integration тесты — в разработке
- I5. ✅ Документирование в R1 файлах

---

## ⏰ Бонусы (опционально)

Фичи: WebSocket, рекомендации, Kubernetes, CI/CD

Задачи:

- B1. ⏳ WebSocket для notifications
- B2. ⏳ Рекомендации фильмов (ML заглушка)
- B3. ⏳ Kubernetes deployment manifests
- B4. ⏳ GitHub Actions CI/CD
- B5. ⏳ Docker контейнеризация

---

## Суммарный статус

| Компонент | Статус |
| ----------- | -------- |
| Backend API | ✅ 95% |
| Database models | ✅ 100% |
| Authentication | ✅ 100% |
| Authorization | ✅ 100% |
| Titles CRUD | ✅ 100% |
| List management | ✅ 100% |
| Reviews | ✅ 100% |
| Ratings | ✅ 100% |
| API Documentation | ✅ 90% |
| UI/Frontend | ⏳ 40% |
| Tests | ✅ 70% |
| Бонусы | ⏳ 0% |
