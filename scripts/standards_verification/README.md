# Standards verification (ручной запуск)

Эта папка содержит материалы и скрипты для ручной проверки нормоконтроля (ИТ).

## Источник стандартов

Все нормы для профиля **ИТ** берутся из файла:
- `scripts/standards_verification/standars_control_it_short.md`

Скрипт **не должен** содержать «захардкоженные» значения полей/шрифтов/интервалов — он парсит их из этого markdown.

## Быстрый старт

Из корня репозитория:

1) Установить зависимости

- `pip install -r requirements.txt`

2) Запустить проверку для тестового документа

- `python scripts/standards_verification/check_it_docx.py`

По умолчанию проверяется:
- `tests/ПЗ.docx`

3) Запустить проверку для своего файла

- `python scripts/standards_verification/check_it_docx.py path/to/Your.docx`

## Результаты

- Отчёт сохраняется в папку: `normocontrol_reports/`
- Формат: Markdown (`it_normocontrol_report_YYYYMMDD_HHMMSS.md`)

Код возврата (exit code):
- `0` — ошибок нет (предупреждения возможны)
- `1` — есть ошибки

## Примечания

- Проверка выполняется в гибридном стиле:
  - OOXML (ZIP + XML) — для полей/размера страницы и низкоуровневых свойств.
  - `python-docx` — для проверки структуры/контента (best-effort).
- Если документ не содержит `header*.xml`, скрипт не сможет подтвердить наличие поля `PAGE` в колонтитулах (это будет предупреждением).

## Какие нормы не проверяются

Ниже перечислены требования из `standars_control_it_short.md`, которые текущий скрипт **не проверяет**, либо проверяет **только частично**.

### 1) Страница и текст

- Односторонняя печать/экспорт в PDF.
- Визуальная позиция номера страницы «в правом верхнем углу» (без рендера страниц это проверить корректно нельзя).
- Правило «титульный лист входит в нумерацию, но номер на нём не печатается» (требует логики по страницам/секциям и/или рендер).

### 2) Структура ПЗ

- Проверка «Реферат: 500–800 знаков; 5–15 ключевых слов».
- Проверка «Приложения (при необходимости)» как условной опции (сейчас скрипт требует все пункты из списка буквально).

### 3) Заголовки и нумерация

- Иерархия нумерации (1 → 1.1 → 1.1.1 → 1.1.1.1).
- Требования к заголовкам: полужирные, без переносов слов, без точки в конце.
- Интервалы до/после заголовков и единообразие интервалов.
- Проверка, что «Введение/Заключение/Список источников/Приложения» — без номера.

### 4) Ссылки и источники

- Полное соответствие: «все источники, на которые есть ссылки, присутствуют в списке» и «порядок — по появлению ссылок». Сейчас есть только простая эвристика.
- Формат нумерации источников «без точки» проверяется нестрого.

### 5) Формулы и расчёты

- Наличие/проверка единиц СИ и переводов в СИ.
- Оформление формул (пустые строки сверху/снизу), нумерация формул, номер справа в круглых скобках.
- Наличие расшифровки символов со слова «где» (без двоеточия).
- Проверка ссылок на источники для коэффициентов/значений.

### 6) Рисунки, схемы, диаграммы

- Проверка, что рисунок расположен «сразу после первого упоминания».
- Проверка наличия ссылки на каждый рисунок в тексте.
- Центровка подписи (сейчас проверяется только формат строки).
- Требования к диаграммам (подписи осей, единицы, шкалы, Excel‑правила).

### 7) Таблицы

- Проверка «таблица сразу после первого упоминания» и наличия ссылки.
- Проверка размещения названия над таблицей слева (сейчас только формат строки).
- Проверка «№ п/п не использовать как отдельный столбец».
- Проверка «Продолжение таблицы N» при переносе и нумерации колонок.

### 8) Приложения

- Проверка ссылок на каждое приложение в тексте.
- Проверка порядка приложений по первым ссылкам.
- Проверка формата «ПРИЛОЖЕНИЕ А» + заголовок по центру.

### 9) Язык и оформление текста

- Разговорный стиль/«свои» сокращения.
- Запрет математических знаков без чисел.
- Пробел между числом и единицей («100 кВт», «80 %», «20 °С»).
- Запрет переносов «число на одной строке, единица на другой».

### 10) Мини‑проверка перед сдачей

- Соответствие оглавления названиям/номерам страниц (требует анализа полей оглавления и/или рендер).
- Полная проверка, что все рисунки/таблицы/приложения упомянуты в тексте.
- Проверка аккуратности переносов/внешнего вида PDF.
